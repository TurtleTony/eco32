/*
 * rep.c -- test the representation of fp numbers
 */


#include <stdio.h>
#include <stdlib.h>
#include <math.h>

#include "../include/fp.h"


/**************************************************************/


void dump(float x) {
  _FP_Union X;

  X.f = x;
  printf("%e = 0x%08X = (%c,%d,0x%06X)",
         X.f, X.w, _FP_SGN(X.w) ? '-' : '+',
         _FP_EXP(X.w), _FP_FRC(X.w));
}


/**************************************************************/


void test_single(float x, _FP_Word w) {
  _FP_Union R;

  printf("x = ");
  dump(x);
  printf("\n");
  R.w = w;
  printf("r = ");
  dump(R.f);
  printf("\n");
}


/**************************************************************/


int main(void) {
  printf("------------------------------------------------\n");
  test_single(+0.0, 0x00000000);
  printf("------------------------------------------------\n");
  test_single(-0.0, 0x80000000);
  printf("------------------------------------------------\n");
  test_single(+1.0, 0x3F800000);
  printf("------------------------------------------------\n");
  test_single(-1.0, 0xBF800000);
  printf("------------------------------------------------\n");
  test_single(+2.0, 0x40000000);
  printf("------------------------------------------------\n");
  test_single(-2.0, 0xC0000000);
  printf("------------------------------------------------\n");
  test_single(+0.5, 0x3F000000);
  printf("------------------------------------------------\n");
  test_single(-0.5, 0xBF000000);
  printf("------------------------------------------------\n");
  test_single(+0.875, 0x3F600000);
  printf("------------------------------------------------\n");
  test_single(-0.875, 0xBF600000);
  printf("------------------------------------------------\n");
  test_single(+123.456, 0x42F6E979);
  printf("------------------------------------------------\n");
  test_single(-123.456, 0xC2F6E979);
  printf("------------------------------------------------\n");
  test_single(+345e12, 0x579CE349);
  printf("------------------------------------------------\n");
  test_single(-345e12, 0xD79CE349);
  printf("------------------------------------------------\n");
  test_single(+345e-12, 0x2FBDAA6F);
  printf("------------------------------------------------\n");
  test_single(-345e-12, 0xAFBDAA6F);
  printf("------------------------------------------------\n");
  return 0;
}
